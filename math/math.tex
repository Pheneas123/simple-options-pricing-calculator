\documentclass[12pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{bm}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{xcolor}

\geometry{margin=1in}
\setlength{\parskip}{6pt}
\setlength{\parindent}{0pt}

\hypersetup{
  colorlinks = true,
  linkcolor = blue,
  citecolor = blue,
  urlcolor  = blue,
  pdftitle  = {Options Calculator Maths},
  pdfauthor = {Pheneas Newman}
}
\usepackage{pagecolor}
\definecolor{darkbg}{HTML}{1E1E1E} 
\pagecolor{darkbg}    
\definecolor{darkfont}{HTML}{CCCCCC}
\color{darkfont}         
\definecolor{blue1}{HTML}{9CDCFE}
\definecolor{purple1}{HTML}{C586C0}

\begin{document}

\title{Mathematics Behind the Options Calculator}
\author{Pheneas Newman}
\date{\today}
\maketitle

\section{European Call}

\[
  \begin{aligned}
    C   & = S e^{-qT} \Phi(d_1) - K e^{-rT} \Phi(d_2) \\ 
    d_1 & = \frac{\ln\!\left(\tfrac{S}{K}\right) + (r - q + \tfrac{1}{2}\sigma^2)T}{\sigma \sqrt{T}} \\
    d_2 & = d_1 - \sigma \sqrt{T}
  \end{aligned}
\]

\[
  \boxed{S e^{-qT}\,\phi(d_1) = K e^{-rT}\,\phi(d_2)}
  \qquad\text{(Black-Scholes identity)}
\]

\begin{description}
  \item[$C$] Option price
  \item[$S$] Spot price
  \item[$K$] Strike price
  \item[$q$] Dividend rate
  \item[$T$] Time to maturity
  \item[$r$] Risk-free rate
  \item[$\sigma$] Volatility
  \item[$\Phi$] Standard normal CDF
  \item[$\phi$] Standard normal pdf
\end{description}

\subsection{Delta}
\[
  \boxed{\Delta = \frac{\partial C}{\partial S} = e^{-qT}\Phi(d_1)}
\]

\[
  \begin{aligned}
    \Delta & = \frac{\partial C}{\partial S} = e^{-qT}\Phi(d_1) + Se^{-q T}\phi(d_1)\left(\frac{\partial d_1}{\partial S}\right) - Ke^{-rT}\phi(d_2)\left(\frac{\partial d_2}{\partial S} \right) \\
           & = e^{-qT}\Phi(d_1) + \underbrace{Se^{-qT}\phi(d_1)\frac{1}{S \sigma \sqrt{T}} - Ke^{-rT}\phi(d_2)\frac{1}{S \sigma \sqrt{T}}}_{=\,0} \\
    \Delta & = e^{-qT}\Phi(d_1)
  \end{aligned}
\]

\subsection{Gamma}

\[
  \boxed{\Gamma = \frac{\partial^2 C}{\partial S^2} = e^{-qT}(\phi(d_1)\frac{1}{S\sigma\sqrt{T}}) }
\]

\[
  \begin{aligned}
    \Gamma & = \frac{\partial^2 C}{\partial S^2} = \frac{\partial \Delta}{\partial S} \\
           & = e^{-qT}\frac{\partial}{\partial S}(\Phi(d_1)) \\
    \Gamma & = e^{-qT}\phi(d_1)\frac{1}{S\sigma\sqrt{T}} \\
  \end{aligned}
\]

\subsection{Vega}

\[
\boxed{\mathcal{V} = \frac{\partial C}{\partial \sigma} = Se^{-qT}\phi(d_1)\sqrt{T}}
\]

\[
  \begin{aligned}
    \mathcal{V} & = \frac{\partial C}{\partial \sigma} 
          = Se^{-qT}\phi(d_1)\left(\frac{\partial d_1}{\partial \sigma}\right) 
            - K e ^{-r T} \phi(d_2) \left(\frac{\partial d_2}{\partial \sigma}\right) \\[4pt]
    & \textcolor{purple1}{\frac{\partial d_1}{\partial \sigma} 
      = \frac{\partial}{\partial \sigma}\!\left(\frac{\ln(\tfrac{S}{K})}{\sigma \sqrt{T}} 
        + \frac{T(r - q)}{\sigma \sqrt{T}} \right) + \frac{1}{2} \sqrt{T}}  \\[6pt]
    & \textcolor{blue1}{\frac{\partial d_2}{\partial \sigma} 
      = \frac{\partial}{\partial \sigma}\!\left(\frac{\ln(\tfrac{S}{K})}{\sigma \sqrt{T}} 
        + \frac{T(r - q)}{\sigma \sqrt{T}} \right) - \frac{1}{2} \sqrt{T}} \\[6pt]
    & \textcolor{purple1}{\frac{\partial d_1}{\partial \sigma}}
      - \textcolor{blue1}{\frac{\partial d_2}{\partial \sigma}}
      = \sqrt{T} \\[6pt]
    \mathcal{V} & = Se^{-qT}\phi(d_1)\sqrt{T}
  \end{aligned}
\]

\subsection{Theta}
\[
\boxed{\Theta = \frac{\partial C}{\partial T}= -e^{-qT} \frac{S\phi(d_1)\sigma}{2\sqrt{T}} - rKe^{-rT}\Phi(d_2) + qSe^{-qT}\Phi(d_1)} \\
\]

\[
  \begin{aligned}
    \Theta & = \frac{\partial C}{\partial T} = S\left(-qe^{-qT}\Phi(d_1) + e^{-qT}\phi(d_1)\frac{\partial d_1}{\partial T}\right) - K\left(-re^{-rT}\Phi(d_2) + e^{-rT}\phi(d_2)\frac{\partial d_2}{\partial T}\right) \\[6pt]
    & \textcolor{purple1}{\frac{\partial d_1}{\partial T} = \frac{(\sigma^2 + 2r - 2q)T - 2\ln(\tfrac{S}{K})}{4\sigma T^{\frac{3}{2}}} \coloneqq A} \\[6pt]
    & \textcolor{blue1}{\frac{\partial d_2}{\partial T} = \frac{(\sigma^2 + 2r - 2q)T - 2\ln(\tfrac{S}{K})}{4\sigma T^{\frac{3}{2}}} - \frac{\sigma}{2\sqrt{T}} \coloneqq A - \frac{\sigma}{2\sqrt{T}}} \\[6pt]
    & = Se^{-qT}(-q\Phi(d_1) + \phi(d_1)A) - Ke^{-rT}(-r\Phi(d_2) + \phi(d_2)(A - \tfrac{\sigma}{2\sqrt{T}})) \\[6pt]
    & = -qSe^{-qT}\Phi(d_1) + rKe^{-rT}\Phi(d_2) + Ke^{-rT}\phi(d_2)\tfrac{\sigma}{2\sqrt{T}} + \underbrace{A(Se^{-qT}\phi(d_1) - Ke^{-rT}\phi(d_2))}_{= 0} \\[6pt]
    & = Ke^{-rT}\phi(d_2)\tfrac{\sigma}{2\sqrt{T}} + rKe^{-rT}\Phi(d_2) - qSe^{-qT}\Phi(d_1) \\[8pt]
    & \text{\parbox{0.85\linewidth}{Using the Black-Scholes identity $S e^{-qT}\phi(d_1) = K e^{-rT}\phi(d_2)$, and expressing $\Theta$ as the negative:}} \\[4pt]
    \Theta & = -e^{-qT} \frac{S\phi(d_1)\sigma}{2\sqrt{T}} - rKe^{-rT}\Phi(d_2) + qSe^{-qT}\Phi(d_1)
  \end{aligned}
\]

\subsection{Rho}

\[
\boxed{ \rho = \frac{\partial C}{\partial r}= KTe^{-rT}\Phi(d_2)} \\
\]

\[
  \begin{aligned}
    \rho & = \frac{\partial C}{\partial r} = Se^{-qT}(\phi(d_1)\frac{\partial d_1}{\partial r}) - K(-Te^{-rT}\Phi(d_2) + e^{-rT}\phi(d_2)\frac{\partial d_2}{\partial r}) \\ 
         & \textcolor{purple1}{\frac{\partial d_1}{\partial r} = \frac{T}{\sigma \sqrt{T}} = \frac{\sqrt{T}}{\sigma} = \frac{\partial d_2}{\partial r}} \\[6pt]
         & = Se^{-qT}\phi(d_1)\frac{\sqrt{T}}{\sigma} + KTe^{-rT}\Phi(d_2) - Ke^{-rT}\phi(d_2)\frac{\sqrt{T}}{\sigma} \\ 
         & = \frac{\sqrt{T}}{\sigma}\left(\underbrace{Se^{-qT}\phi(d_1) - Ke^{-rT}\phi(d_2)}_{= 0}\right) + KTe^{-rT}\Phi(d_2) \\ 
         \rho & = KTe^{-rT}\Phi(d_2)
  \end{aligned}
\]

\newpage

\section{European Put}

\[
  \begin{aligned}
    P   & = K e^{-rT}\,\Phi(-d_2) \;-\; S e^{-qT}\,\Phi(-d_1) \\
    d_1 & = \frac{\ln\!\left(\tfrac{S}{K}\right) + (r - q + \tfrac{1}{2}\sigma^2)T}{\sigma \sqrt{T}} \\
    d_2 & = d_1 - \sigma \sqrt{T}
  \end{aligned}
\]

\begin{description}
  \item[$P$] Option price
  \item[$S$] Spot price
  \item[$K$] Strike price
  \item[$q$] Dividend rate
  \item[$T$] Time to maturity
  \item[$r$] Risk-free rate
  \item[$\sigma$] Volatility
  \item[$\Phi$] Standard normal CDF
  \item[$\phi$] Standard normal pdf
\end{description}

\subsection{Delta}

\[
  \boxed{\Delta = \frac{\partial P}{\partial S} = -e^{-qT}\Phi(-d_1)} \\
\]

\[
  \begin{aligned}
    \Delta & = \frac{\partial P}{\partial S} = Ke^{-rT}\phi(d_2)\left(-\frac{\partial d_2}{\partial S}\right) - e^{-qT}\left(\Phi(-d_1) + S\phi(-d_1)\left(-\frac{\partial d_1}{\partial S}\right)\right) \\
    \text{Using Black-Scholes identity} \\
    \Delta & = -e^{-qT}\Phi(-d_2) \\
  \end{aligned}
\]

\subsection{Gamma}

\[
  \boxed{\Gamma = \frac{\partial^2 P}{\partial S^2} = e^{-qT}\frac{\phi(d_1)}{S\sigma\sqrt{T}} = Ke^{-rT} \frac{\phi(d_2)}{S^2\sigma\sqrt{T}}}\\
\]

\[
  \begin{aligned}
  \end{aligned}
\]

Same as European Call derivation.

\subsection{Vega}

\[
  \boxed{\mathcal{V} = \frac{\partial^2 P}{\partial S^2} = e^{-qT}\frac{\phi(d_1)}{S\sigma\sqrt{T}} = Ke^{-rT} \frac{\phi(d_2)}{S^2\sigma\sqrt{T}}}\\
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Theta}

\[
  \boxed{\Theta = \frac{\partial P}{\partial T} = -e^{-qT}\frac{S\phi(d_1)\sigma}{2\sqrt{T}} + rKe^{-rT}\Phi(-d_2) - qSe^{-qT}\Phi(-d_1)}\\
\]


\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Rho}

\[
  \boxed{\rho = \frac{\partial P}{\partial r} = TKe^{-rT}\Phi(-d_2)}\\
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\newpage

\section{Binary Call (Cash-or-Nothing)}

\[
  \begin{aligned}
    C_{\mathrm{bin}} & = Q \, e^{-rT} \,\Phi(d_2) \\
    d_1 & = \frac{\ln\!\left(\tfrac{S}{K}\right) + (r - q + \tfrac{1}{2}\sigma^2)T}{\sigma \sqrt{T}} \\
    d_2 & = d_1 - \sigma \sqrt{T}
  \end{aligned}
\]

\begin{description}
  \item[$C_{\mathrm{bin}}$] Option price
  \item[$Q$] Fixed cash payout if \( S_T > K \)
  \item[$S$] Spot price
  \item[$K$] Strike price
  \item[$q$] Dividend rate
  \item[$T$] Time to maturity
  \item[$r$] Risk-free rate
  \item[$\sigma$] Volatility
  \item[$\Phi$] Standard normal CDF
  \item[$\phi$] Standard normal pdf
\end{description}

\subsection{Delta}
\[
  \boxed{\Delta = \frac{\partial C_{\mathrm{bin}}}{\partial S} 
  = Q\, e^{-rT}\, \frac{\phi(d_2)}{S\,\sigma\,\sqrt{T}}}
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Gamma}
\[
  \boxed{\Gamma = \frac{\partial^2 C_{\mathrm{bin}}}{\partial S^2} 
  = -Q\, e^{-rT}\, \frac{d_1\,\phi(d_2)}{S^2\,\sigma^2\,T}}
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Vega}
\[
  \boxed{\mathcal{V} = \frac{\partial C_{\mathrm{bin}}}{\partial \sigma} 
  = -Q\, e^{-rT}\, d_1\,\phi(d_2)}
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Theta}
\[
  \boxed{\Theta = \frac{\partial C_{\mathrm{bin}}}{\partial T}
  = Q\, e^{-rT}\!\left[
  -r\,\Phi(d_2) 
  + \frac{\phi(d_2)}{2T}
    \left(
      \frac{\ln(\tfrac{S}{K}) + (r - q - \tfrac{1}{2}\sigma^2)T}{\sigma\sqrt{T}}
    \right)
  \right]}
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Rho}
\[
  \boxed{\rho = \frac{\partial C_{\mathrm{bin}}}{\partial r}
  = Q\, e^{-rT}\!\left(
    -T\,\Phi(d_2)
    + \frac{\sqrt{T}}{\sigma}\,\phi(d_2)
  \right)}
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\newpage

\section{Binary Put (Cash-or-Nothing)}

\[
  \begin{aligned}
    P_{\mathrm{bin}} & = Q \, e^{-rT} \,\Phi(-d_2) \\ 
    d_1 & = \frac{\ln\!\left(\tfrac{S}{K}\right) + (r - q + \tfrac{1}{2}\sigma^2)T}{\sigma \sqrt{T}} \\
    d_2 & = d_1 - \sigma \sqrt{T}
  \end{aligned}
\]

\begin{description}
  \item[$P_{\mathrm{bin}}$] Option price
  \item[$Q$] Fixed cash payout if \( S_T < K \)
  \item[$S$] Spot price
  \item[$K$] Strike price
  \item[$q$] Dividend rate
  \item[$T$] Time to maturity
  \item[$r$] Risk-free rate
  \item[$\sigma$] Volatility
  \item[$\Phi$] Standard normal CDF
  \item[$\phi$] Standard normal pdf
\end{description}

\subsection{Delta}
\[
  \boxed{\Delta = \frac{\partial P_{\mathrm{bin}}}{\partial S}
  = -Q\, e^{-rT}\, \frac{\phi(d_2)}{S\,\sigma\,\sqrt{T}}}
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Gamma}
\[
  \boxed{\Gamma = \frac{\partial^2 P_{\mathrm{bin}}}{\partial S^2}
  = Q\, e^{-rT}\, \frac{d_1\,\phi(d_2)}{S^2\,\sigma^2\,T}}
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Vega}
\[
  \boxed{\mathcal{V} = \frac{\partial P_{\mathrm{bin}}}{\partial \sigma}
  = Q\, e^{-rT}\, d_1\,\phi(d_2)}
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Theta}
\[
  \boxed{\Theta = \frac{\partial P_{\mathrm{bin}}}{\partial T}
  = Q\, e^{-rT}\!\left[
  -r\,\Phi(-d_2)
  - \frac{\phi(d_2)}{2T}
    \left(
      \frac{\ln(\tfrac{S}{K}) + (r - q - \tfrac{1}{2}\sigma^2)T}{\sigma\sqrt{T}}
    \right)
  \right]}
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Rho}
\[
  \boxed{\rho = \frac{\partial P_{\mathrm{bin}}}{\partial r}
  = Q\, e^{-rT}\!\left(
    -T\,\Phi(-d_2)
    - \frac{\sqrt{T}}{\sigma}\,\phi(d_2)
  \right)}
\]

\[
  \begin{aligned}
  \end{aligned}
\]

\newpage

\section{American Call}

\[
  \begin{aligned}
    C^{A} & = \sup_{\tau \in \mathcal{T}[0,T]} \mathbb{E}^{\mathbb{Q}}\!\left[ e^{-r \tau}\,(S_{\tau}-K)^{+} \right] \\[4pt]
          & \quad \text{(equals the European call when $q=0$, since early exercise has no value).}
  \end{aligned}
\]

\begin{description}
  \item[$C^{A}$] American call option price
  \item[$S$] Spot price
  \item[$K$] Strike price
  \item[$q$] Dividend rate
  \item[$T$] Time to maturity
  \item[$r$] Risk-free rate
  \item[$\sigma$] Volatility
  \item[$\tau$] Optimal stopping time (\( 0 \le \tau \le T \))
  \item[$\mathbb{E}^{\mathbb{Q}}$] Expectation under the risk-neutral measure
\end{description}

\subsection{Delta}
\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Gamma}
\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Vega}
\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Theta}
\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Rho}
\[
  \begin{aligned}
  \end{aligned}
\]

\newpage

\section{American Put}

\[
  \begin{aligned}
    P^{A} & = \sup_{\tau \in \mathcal{T}[0,T]} \mathbb{E}^{\mathbb{Q}}\!\left[ e^{-r \tau}\,(K-S_{\tau})^{+} \right]
  \end{aligned}
\]

\begin{description}
  \item[$P^{A}$] American put option price
  \item[$S$] Spot price
  \item[$K$] Strike price
  \item[$q$] Dividend rate
  \item[$T$] Time to maturity
  \item[$r$] Risk-free rate
  \item[$\sigma$] Volatility
  \item[$\tau$] Optimal stopping time (\( 0 \le \tau \le T \))
  \item[$\mathbb{E}^{\mathbb{Q}}$] Expectation under the risk-neutral measure
\end{description}

\subsection{Delta}
\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Gamma}
\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Vega}
\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Theta}
\[
  \begin{aligned}
  \end{aligned}
\]

\subsection{Rho}
\[
  \begin{aligned}
  \end{aligned}
\]

\end{document}
